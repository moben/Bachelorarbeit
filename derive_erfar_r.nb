(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     14442,        313]
NotebookOptionsPosition[     14207,        300]
NotebookOutlinePosition[     14541,        315]
CellTagsIndexPosition[     14498,        312]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"f", "[", "r_", "]"}], " ", ":=", " ", 
    RowBox[{"1.0", "*", 
     RowBox[{
      RowBox[{"Erf", "[", 
       RowBox[{"alpha", "*", "r"}], "]"}], "/", "r"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"replacements", "[", "p_", "]"}], ":=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<Power(ar,2)\>\"", "\[Rule]", "\"\<ar2\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<Power(r,\>\"", "<>", 
        RowBox[{"ToString", "[", "p", "]"}], "<>", "\"\<)\>\""}], "\[Rule]", 
       "\"\<pow_der\>\""}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<Power\>\"", "\[Rule]", "\"\<fcs_pow\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<Sqrt(Pi)\>\"", "\[Rule]", "\"\<FCS_SQRTPI\>\""}]}], 
     "}"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "Print", "[", "\"\<  /* This code was generated with Mathematica. */\>\"", 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "Print", "[", "\"\<  fcs_float pow_der = fcs_pow(r,der);\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<  fcs_float pow_der_1 = pow_der*r;\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<  fcs_float alpha = param[0];\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "Print", "[", "\"\<  if (fcs_float_is_zero(pow_der_1)) {\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<    switch(der){\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"p", "=", "0"}], ",", 
   RowBox[{"p", "\[LessEqual]", "21"}], ",", " ", 
   RowBox[{"p", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"l", "=", 
     RowBox[{"CForm", "[", 
      RowBox[{"Limit", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"f", "[", "r", "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"r", ",", "p"}], "}"}]}], "]"}], ",", 
        RowBox[{"r", "\[Rule]", "0"}]}], "]"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"code", " ", "=", " ", 
     RowBox[{"StringReplace", "[", 
      RowBox[{
       RowBox[{"ToString", "[", "l", "]"}], ",", " ", 
       RowBox[{"replacements", "[", "p", "]"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<      case \>\"", ",", "p", ",", "\"\<: return \>\"", ",", "code", 
      ",", "\"\<;\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<      default: return 0.0;\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<    }\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<  } else {\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<    fcs_float poly = 0.0;\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<    fcs_float ar = alpha*r;\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<    fcs_float ar2 = ar*ar;\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<    switch(der){\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"p", "=", "0"}], ",", 
   RowBox[{"p", "\[LessEqual]", "21"}], ",", " ", 
   RowBox[{"p", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"p", "\[Equal]", "0"}], ",", " ", 
      RowBox[{
       RowBox[{
       "Print", "[", "\"\<      case 0: return fcs_erf(ar)/r;\>\"", "]"}], 
       ";", " ", 
       RowBox[{"Continue", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"h", "[", "r_", "]"}], "=", 
     RowBox[{"HornerForm", "[", "\[IndentingNewLine]", 
      RowBox[{"FullSimplify", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"f", "[", "r", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"r", ",", "p"}], "}"}]}], "]"}], "-", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"-", "1"}], ")"}], "^", "p"}], "*", 
            RowBox[{"p", "!"}], "*", 
            RowBox[{
             RowBox[{"Erf", "[", 
              RowBox[{"alpha", "*", "r"}], "]"}], "/", 
             RowBox[{"Power", "[", 
              RowBox[{"r", ",", 
               RowBox[{"p", "+", "1"}]}], "]"}]}]}]}], ")"}], " ", "*", " ", 
         RowBox[{"Power", "[", 
          RowBox[{"E", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"alpha", "*", "r"}], ")"}], "^", "2"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ar", "\[Equal]", 
         RowBox[{"alpha", "*", "r"}]}]}], "]"}], "\[IndentingNewLine]", 
      "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"TraditionalForm", "[", 
        RowBox[{"FullSimplify", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"f", "[", "r", "]"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"r", ",", "p"}], "}"}]}], "]"}], ",", 
          RowBox[{"ar", "==", 
           RowBox[{"alpha", "*", "r"}]}]}], "]"}], "]"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"h", "[", "r", "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
     "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"code", "=", 
     RowBox[{"CForm", "[", 
      RowBox[{"h", "[", "r", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"code", "=", 
     RowBox[{"StringReplace", "[", 
      RowBox[{
       RowBox[{"ToString", "[", "code", "]"}], ",", "  ", 
       RowBox[{"replacements", "\[InvisibleSpace]", "[", "p", "]"}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<      case \>\"", ",", " ", "p", ",", " ", "\"\<: poly = \>\"", ",",
       " ", "code", ",", "\"\<; break;\>\""}], "]"}], ";"}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<      default: return 0.0;\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<    }\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "Print", "[", 
   "\"\<    return poly * fcs_exp(-ar2) \\\n+ (der % 2 ? -1 : 1) * fak(der) * \
fcs_erf(ar) / pow_der_1;\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<  }\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.625226979282825*^9, 3.625227041649686*^9}, {
   3.625227087858899*^9, 3.625227171647085*^9}, {3.625227206393751*^9, 
   3.625227232085816*^9}, {3.625227287459044*^9, 3.625227289480081*^9}, {
   3.6252273216672907`*^9, 3.625227426125042*^9}, 3.625227475803163*^9, {
   3.6252276830019073`*^9, 3.6252277312394457`*^9}, {3.625227771634392*^9, 
   3.625227802688998*^9}, {3.6252278864382668`*^9, 3.625227905182931*^9}, {
   3.625228505157338*^9, 3.625228552126973*^9}, {3.6252285927339163`*^9, 
   3.625228636483033*^9}, {3.625228678586591*^9, 3.6252287014973497`*^9}, 
   3.625228760552964*^9, {3.6252293874886293`*^9, 3.6252294009074497`*^9}, {
   3.625229464816618*^9, 3.625229586126276*^9}, {3.6252296470769157`*^9, 
   3.625229715445579*^9}, {3.625229758051495*^9, 3.625229773055583*^9}, {
   3.625229893369685*^9, 3.6252299505600643`*^9}, {3.625229981630095*^9, 
   3.6252299968095713`*^9}, {3.625230157267364*^9, 3.625230253678362*^9}, 
   3.625230844541811*^9, {3.625231526953442*^9, 3.625231530099553*^9}, 
   3.625231571104198*^9, {3.625231661663172*^9, 3.625231713177704*^9}, {
   3.6252317523993807`*^9, 3.6252317529494667`*^9}, {3.6252318006431227`*^9, 
   3.625231853166152*^9}, {3.625231884605976*^9, 3.6252319080699368`*^9}, {
   3.6252320374035997`*^9, 3.6252320615337*^9}, {3.625232155991848*^9, 
   3.625232156845729*^9}, {3.625232187016735*^9, 3.625232219995408*^9}, 
   3.6252323224669847`*^9, {3.625232879719935*^9, 3.625232988411498*^9}, {
   3.625233057234878*^9, 3.625233081154954*^9}, {3.625233124332308*^9, 
   3.625233131359438*^9}, {3.625233241396119*^9, 3.625233259312755*^9}, {
   3.625233299809746*^9, 3.6252333060214243`*^9}, {3.625233451458066*^9, 
   3.625233488636808*^9}, {3.625233520700993*^9, 3.62523354730214*^9}, {
   3.625233595287013*^9, 3.625233600025474*^9}, {3.625233634363542*^9, 
   3.625233651225151*^9}, {3.625233731780842*^9, 3.625233732271262*^9}, {
   3.6252338261735783`*^9, 3.625233855918037*^9}, {3.625233889926712*^9, 
   3.625233908867363*^9}, {3.625233954354986*^9, 3.6252339578450413`*^9}, {
   3.625234230437347*^9, 3.6252342571964417`*^9}, {3.625234484130497*^9, 
   3.625234498696027*^9}, {3.6252345428520517`*^9, 3.62523456990382*^9}, {
   3.625234613117375*^9, 3.6252346371157227`*^9}, {3.625234703933688*^9, 
   3.625234858679408*^9}, {3.6252349432847433`*^9, 3.625234945640149*^9}, {
   3.6252349911502542`*^9, 3.62523499253227*^9}, {3.625235156955482*^9, 
   3.625235157146838*^9}, {3.6252352495118093`*^9, 3.625235325759777*^9}, {
   3.625246689666671*^9, 3.625246690456328*^9}, {3.6252635552381973`*^9, 
   3.625263555480423*^9}, {3.625263882220996*^9, 3.625263941297518*^9}, {
   3.625263992721157*^9, 3.6252639933161983`*^9}, {3.6252640885604343`*^9, 
   3.625264107471458*^9}, {3.6252641712884903`*^9, 3.625264172742345*^9}, {
   3.6252642570703573`*^9, 3.6252642609344893`*^9}, {3.6252643224364567`*^9, 
   3.625264324870593*^9}, {3.6252643799937973`*^9, 3.625264401328835*^9}, {
   3.625264480774411*^9, 3.62526450322192*^9}, {3.625264630151971*^9, 
   3.625264674998805*^9}, {3.625264728439742*^9, 3.62526473240209*^9}, 
   3.625264818702507*^9, {3.625264966783969*^9, 3.625264968857101*^9}, {
   3.62526516387646*^9, 3.625265184556444*^9}, {3.625265789657*^9, 
   3.625265799617116*^9}, {3.6252698866183853`*^9, 3.625269967575626*^9}, {
   3.6252701341586237`*^9, 3.625270147943244*^9}, {3.62534918692241*^9, 
   3.625349195297176*^9}, {3.625351500015074*^9, 3.625351567378901*^9}, {
   3.625351715792354*^9, 3.625351758433201*^9}, {3.625351823825657*^9, 
   3.625351826274869*^9}, {3.625351868041855*^9, 3.6253518970397167`*^9}, {
   3.62535209397276*^9, 3.625352094873419*^9}, {3.625352246317739*^9, 
   3.625352254059186*^9}, {3.625352403391426*^9, 3.625352457379052*^9}, {
   3.625352846606928*^9, 3.6253528760553503`*^9}, {3.6253571013629913`*^9, 
   3.625357101562276*^9}, {3.6254541395187798`*^9, 3.625454173708858*^9}, 
   3.6254543121331997`*^9, {3.6254545051140537`*^9, 3.625454643438493*^9}, {
   3.6254546979607363`*^9, 3.625454709142231*^9}, {3.625454769394311*^9, 
   3.6254548102888727`*^9}, {3.625454842429834*^9, 3.625454984715765*^9}, {
   3.625455021623845*^9, 3.625455035797964*^9}, {3.625455162892644*^9, 
   3.625455187436626*^9}, {3.625455244662806*^9, 3.625455246350753*^9}, {
   3.62545738906432*^9, 3.625457396190545*^9}, {3.625457450954866*^9, 
   3.625457451354375*^9}, {3.6254574963442163`*^9, 3.6254574978382397`*^9}, {
   3.625457536224277*^9, 3.6254575435831203`*^9}, {3.625457801189279*^9, 
   3.625457827333867*^9}, {3.625464708757571*^9, 3.6254647510282*^9}, {
   3.625530755833411*^9, 3.625530826414794*^9}, {3.62553088697653*^9, 
   3.625530926913816*^9}, {3.625533291179297*^9, 3.6255332969669733`*^9}, {
   3.625533334439206*^9, 3.6255333397360487`*^9}, {3.625533471208951*^9, 
   3.625533500429737*^9}, {3.62553354551147*^9, 3.625533600601013*^9}, 
   3.625533636609662*^9, {3.62562005893738*^9, 3.6256200599215317`*^9}, {
   3.6256201227332067`*^9, 3.6256201242208223`*^9}, {3.625620281875729*^9, 
   3.62562036705871*^9}, {3.625620406294766*^9, 3.6256204358135757`*^9}, {
   3.6256205094623613`*^9, 3.625620571595696*^9}, {3.625620606358942*^9, 
   3.625620681697131*^9}, {3.6256207186802397`*^9, 3.625620733308717*^9}, {
   3.625620788927412*^9, 3.625620825042297*^9}, {3.625620868273275*^9, 
   3.625620871943462*^9}, {3.6256210649166517`*^9, 3.625621106393187*^9}, {
   3.62562123287239*^9, 3.6256212716265917`*^9}, {3.6256213138997307`*^9, 
   3.62562133983827*^9}, {3.625621460780675*^9, 3.62562146530503*^9}, {
   3.625621497708197*^9, 3.625621498309465*^9}, {3.625621534570882*^9, 
   3.625621561809421*^9}, {3.625621613898219*^9, 3.625621620124825*^9}, {
   3.625621857912203*^9, 3.625621892667645*^9}, {3.625621961682529*^9, 
   3.625622044906302*^9}, 3.625622118512782*^9, {3.625622368406169*^9, 
   3.625622399896496*^9}, {3.625622445704925*^9, 3.625622462743828*^9}, {
   3.625622498811557*^9, 3.625622501044772*^9}, {3.6256227088019857`*^9, 
   3.625622773890007*^9}, 3.625622824779396*^9, {3.625622859455936*^9, 
   3.625622876168154*^9}, {3.6256229403402147`*^9, 3.625623030321966*^9}, {
   3.625623091191153*^9, 3.6256230953042603`*^9}, {3.625623203676786*^9, 
   3.625623227342402*^9}, {3.625623307157825*^9, 3.625623317967923*^9}, {
   3.6256233554262857`*^9, 3.625623364652837*^9}, {3.625623400414784*^9, 
   3.62562340853437*^9}, {3.625623457572649*^9, 3.625623459890221*^9}, {
   3.6256236360057297`*^9, 3.625623640424782*^9}, {3.625623672086864*^9, 
   3.625623676123644*^9}, {3.625624047419817*^9, 3.6256240698034477`*^9}, {
   3.6256244010224457`*^9, 3.625624418610249*^9}, 3.625789572494985*^9}]
},
WindowSize->{1920, 1061},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.0 for Linux x86 (64-bit) (June 27, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 13645, 278, 1133, "Input"]
}
]
*)

(* End of internal cache information *)
